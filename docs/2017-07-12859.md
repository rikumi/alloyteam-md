---
title: QQ 日迹 Omi 实战开发，从 0 到 1
date: 2017-07-14
author: TAT.vorshen
source_link: http://www.alloyteam.com/2017/07/12859/
---

<!-- {% raw %} - for jekyll -->

相信大家对 Omi 应该都不陌生了，如果还有不了解的同学先看看这里。了解并使用 Omi 之后你会发现真的回不去了～～～

[精通 Omi 框架](https://github.com/AlloyTeam/omi/blob/master/tutorial/all.md)

先简单说一下吧，Omi 就是一个可以快速开发项目的组件化框架，和 vue／react 一样为了节省生产力的。想了解 Omi 和 vue 还有 react 区别的，上面文档有讲解，或者加入群 256426170，可以面对面咨询 Omi 作者 dnt。我这篇文章将使用 Omi 从 0 到 1 来完成一个移动端的项目，让大家了解 Omi 开发的方便快捷。

# 开发准备：

这次我们挑选了一个日迹发现页来作为例子开发，如果有用手机 QQ 的同学，应该有知道 “日迹” 这个项目，这次我们就挑选了一个日迹的一个发现页，入口在手机 QQ -> 动态 -> 日迹 -> 右上角发现  
发现页如下

![](http://www.alloyteam.com/wp-content/uploads/2017/07/1-169x300.jpg)

开发一个移动端页面和 PC 上开发是一样的，首先要分析页面划分模块，发现页很简单，可以看成一个列表，然后里面每一块是一个 item  
如果不用组件化的话，ul+li 是不是就可以上手干了～但我们要告别原始社会的开发方式，采用 Omi 框架进行开发，下面就正式开始开发～  

# 开发过程：

## 1/ 脚手架

开发一个项目 (一个页面也是一个项目)，首先我们需要脚手架，脚手架可以从历史项目中复制过来，也可以自己重新搭建。使用 Omi 的话就方便很多啦，我们只需要下面两步

        npm install omi-cli -g
        omi-cli init [project name]
     

然后脚手架就 OK 了，下面简单的看一下脚手架，了解一下项目结构

![](http://www.alloyteam.com/wp-content/uploads/2017/07/2-204x300.png)

下面那些.babelrc／.eslintrc／package.json 等就不说了  
先看目录，config 是配置目录，里面有基础配置和项目配置，一般我们不需要修改  
tools 里面是构建相关，webpack.base.js 是基础配置，然后测试环境和生产环境的区分就靠 script.js 了

src 是开发的目录，也是我们代码所在地，打开 src 再看一下

![](http://www.alloyteam.com/wp-content/uploads/2017/07/3.png)

应该还是很好理解的，page 是页面，这里面每个目录就意味着有一个页面。页面的入口是目录下的 main

component 是组件，组件也是以文件夹为粒度来的，里面一定有一个 js 文件，然后组件相关的资源文件，样式文件也都放在 js 的同一目录下，比如这样

![](http://www.alloyteam.com/wp-content/uploads/2017/07/4-193x300.png)

组件的图片／样式和 js 都有了，那外面的 css／img／js 呢？是一些全局资源和公共方法等，这样一来复用就极为方便了。

## 2/ 正式开发

首先我们引入一下 rem 统一的 js 代码，现在来说用 rem 还是比 px 方便很多的，代码如下：

```javascript
    ;(function(win) {
        var doc = win.document;
        var docEl = doc.documentElement;
        var tid;
 
        function refreshRem() {
            var width = docEl.getBoundingClientRect().width;
            if (width > 540) { // 最大宽度
                width = 540;
            }
            var rem = width / 10; // 将屏幕宽度分成10份， 1份为1rem
            docEl.style.fontSize = rem + 'px';
        }
 
  &n
```


<!-- {% endraw %} - for jekyll -->