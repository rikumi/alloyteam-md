---
title: 优化你的 Grunt 构建
date: 2015-10-31
author: TAT.Fujun
source_link: http://www.alloyteam.com/2015/10/8614/
---

<!-- {% raw %} - for jekyll -->

在前端开发的今天，如果没用过 Grunt 或 Gulp 你还真就不好意思和人打招呼的（今天先说 Grunt）。因为前端开发变得越来越复杂，前端工程化也越来越重要。当然，相信读者都能快速通过 Grunt 完成自己的前端工作流（workflow），下面是一个常见的 Gruntfile.js, 它也的确能很好地工作。

```javascript
module.exports = function (grunt) {
    grunt.initConfig({
        pkg: grunt.file.readJSON("package.json"),
        concat: {
            dist: {
                src: ["src/js/jquery.js", "src/js/index.js", "src/js/main.js"],
                dest: "dist/build.js",
            },
        },
        imagemin: {
            options: {
                cache: false,
            },
            dist: {
                files: [
                    {
                        expand: true,
                        cwd: "src/",
                        src: ["**/*.{png,jpg,gif}"],
                        dest: "dist/",
                    },
                ],
            },
        },
    });
    grunt.loadNpmTasks("grunt-contrib-concat");
    grunt.loadNpmTasks("grunt-contrib-imagemin");
    grunt.registerTask("default", ["concat", "imagemin"]);
};
```

但随着你的项目迭代，你很可能会加入更多的构建 task，然后你的 Gruntfile.js 很可能会变成几百行，甚至上千行的大文件，而且，通常在这个时候，你也很可能会遇到构建太慢的尴尬，简单的一次文件修改要花费数秒，甚至更长的时间才能完成构建。这种体验就好比在一个 2G 内存的电脑上，同时开着 10 多个 Sublime 在写代码一样，影响工作效率不说，更影响心情。本文将与大家一起探讨 Grunt 在以下两方面的优化：

1. 瘦身 Gruntfile.js  
2. 减少构建任务时间  

 

**Gruntfile.js 瘦身**

1. 使用 load-grunt-tasks（<https://www.npmjs.com/package/load-grunt-tasks）>  
此 grunt 插件会根据 package.json 加载相应的 Grunt 任务，帮我们省去了手动加载的麻烦。

2. 使用 load-grunt-config（<https://www.npmjs.com/package/load-grunt-config），这时你的> Gruntfile.js 会变得非常简单：


<!-- {% endraw %} - for jekyll -->